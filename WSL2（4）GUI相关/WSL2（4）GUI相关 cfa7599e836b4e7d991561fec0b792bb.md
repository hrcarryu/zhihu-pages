# WSL2ï¼ˆ4ï¼‰GUIç›¸å…³

æ—¶é—´: May 13, 2022 9:32 PM
æ ‡ç­¾: GUI, WSL2, è™šæ‹Ÿæœº
çŠ¶æ€: Yes
ç±»å‹: æ“ä½œç³»ç»Ÿ

# 1. è¿è¡ŒGUIåº”ç”¨

<aside>
ğŸ’¡ 4.16æ›´æ–°ï¼šå¤ªèµäº†ï¼Œ4æœˆ7å·ä»¥åWSL2å¯ä»¥æ”¯æŒGUIäº†ï¼Œåˆ©å¥½pygameã€matplotlibã€‚

</aside>

[ä½¿ç”¨ WSL è¿è¡Œ Linux GUI åº”ç”¨](https://docs.microsoft.com/zh-cn/windows/wsl/tutorials/gui-apps)

å‰ææ¡ä»¶ï¼š

- Windows 11 å†…éƒ¨ç‰ˆæœ¬ 22000æˆ–æ›´é«˜ç‰ˆæœ¬
- å·²å®‰è£…é€‚ç”¨äº GPU çš„é©±åŠ¨ç¨‹åº

å®‰è£…å‘½ä»¤ï¼š

```python
# å…¨æ–°å®‰è£…ï¼Œ ç„¶åé‡å¯
wsl --install -d Ubuntu

# ç°æœ‰WSLå‡çº§
wsl --update
wsl --shutdown
```

å¸¸ç”¨è½¯ä»¶å®‰è£…ï¼š

```python
# gedit
sudo apt install gedit -y
# Nautilus
sudo apt install nautilus -y
```

# 2. å›¾å½¢åŒ–æ¡Œé¢

<aside>
ğŸ¦„ 4.22æ›´æ–°ï¼šåªæ˜¯å›¾ä¸ªæ–°é²œï¼Œå¹¶ä¸èƒ½æé«˜å¤šå°‘æ•ˆç‡ã€‚

</aside>

å®‰è£…ç¯å¢ƒï¼š

- win11ï¼ˆéå¿…é¡»ï¼‰
- WSL2æ”¯æŒGUIç•Œé¢ï¼ˆå¯èƒ½éå¿…é¡»ï¼‰

## 2.1 X server

[Linux Jargon Buster: What is a Display Server in Linux? What is it Used for?](https://itsfoss.com/display-server/)

[èŠèŠLinuxæ“ä½œç³»ç»Ÿä¸­çš„æ˜¾ç¤ºç®¡ç†å™¨åŠå¦‚ä½•æ›´æ¢](https://www.cnblogs.com/cainiaoyige1/p/13992681.html)

linuxçš„å›¾å½¢ç•Œé¢ç¨‹åºæ˜¯å…¸å‹çš„C/Sç»“æ„ï¼Œéœ€è¦ä¸€ä¸ªX serverå’ŒX clientï¼ˆç¨‹åºæœ¬èº«ï¼‰æ‰èƒ½æ­£å¸¸è¿è¡Œã€æ­£å¸¸æ˜¾ç¤ºç»“æœã€‚

å¦‚æœæœ¬åœ°çš„æ“ä½œç³»ç»Ÿæ˜¯linuxï¼Œä¸”æœ‰å›¾å½¢ç•Œé¢ï¼Œå°±è¡¨ç¤ºæœ¬åœ°å·²ç»è¿è¡Œäº†X serverï¼Œåˆ™è¿œç¨‹çš„å›¾å½¢ç•Œé¢X clientä¼šè¿æ¥åˆ°æœ¬åœ°çš„X serverï¼Œå³å¯è¿è¡Œã€‚

å¦‚æœæœ¬åœ°çš„æ“ä½œç³»ç»Ÿæ˜¯windowsï¼Œåˆ™éœ€å¦å¤–è¿è¡Œä¸€ä¸ªX serverç¨‹åºï¼Œç„¶åè¿œç¨‹çš„linuxå›¾å½¢X clientä¼šè¿æ¥æœ¬åœ°çš„xserverï¼Œwindowsç¯å¢ƒä¸‹æ¨èVcXsrvï¼Œå¦‚ä¸‹ã€‚

[FreeXer - free X-server](https://sourceforge.net/projects/freexer/)

ä¸‹è½½åï¼Œå®‰è£…é»˜è®¤é€‰é¡¹å®‰è£…å³å¯ã€‚

## 2.2 ubuntu-desktop

[GNOME æ¡Œé¢](https://link.zhihu.com/?target=https%3A//www.gnome.org/)ï¼Œæ˜¯ Ubuntu é»˜è®¤çš„æ¡Œé¢ï¼Œç¾è§‚åº¦å’ŒåŠŸèƒ½æ€§éƒ½ä¸é”™ï¼Œå®‰è£…ä¹Ÿå¾ˆç®€å•ã€‚

```bash
# é¦–å…ˆï¼Œæ›´æ–°ubuntu
sudo apt update && sudo apt upgrade
# é€šè¿‡taskselå®‰è£…
sudo apt install tasksel
sudo tasksel install ubuntu-desktop
# é€šè¿‡aptå®‰è£…
sudo apt install ubuntu-desktop
```

é…ç½®ç¯å¢ƒå˜é‡ï¼Œè¿™æ ·åé¢å¯ä»¥é€šè¿‡ `gnome-session` å‘½ä»¤å¯åŠ¨æ¡Œé¢ã€‚

```bash
# é…ç½®ç¯å¢ƒå˜é‡ï¼Œæ‰“å¼€é…ç½®æ–‡ä»¶
sudo vi ~/.bashrc
# åœ¨æœ«å°¾æ·»åŠ å¦‚ä¸‹ä¸¤è¡Œåä¿å­˜é€€å‡º
export DISPLAY=$(grep -m 1 nameserver /etc/resolv.conf | awk '{print $2}'):0.0
export XDG_SESSION_TYPE=x11
# åº”ç”¨ä¿®æ”¹
source ~/.bashrc
```

gnomeæ¡Œé¢æ˜¯åŸºäº `systemd`ï¼Œè€ŒWSLä¸æ”¯æŒsystemdï¼Œæ‰€ä»¥éœ€è¦å…ˆå®‰è£…systemdï¼Œè¿™é‡Œç”¨åˆ°githubä¸Šçš„åº“ï¼Œæ“ä½œä¹Ÿå¾ˆç®€å•ã€‚

[GitHub - DamionGans/ubuntu-wsl2-systemd-script: Script to enable systemd support on current Ubuntu WSL2 images [Unsupported, no longer updated]](https://github.com/DamionGans/ubuntu-wsl2-systemd-script)

```bash
# å®‰è£…
git clone https://github.com/DamionGans/ubuntu-wsl2-systemd-script.git
cd ubuntu-wsl2-systemd-script/
bash ubuntu-wsl2-systemd-script.sh
# æµ‹è¯•ï¼Œé‡å¯linuxåæ‰§è¡Œï¼Œè‹¥æ— æŠ¥é”™åˆ™æˆåŠŸ
systemctl
```

è¿™æ ·å®‰è£…å¥½ä»¥åï¼Œwindowså¼€å§‹èœå•ä¼šå‡ºç°å¥½å¤šåº”ç”¨ï¼Œå¦‚æœwsl2å·²æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œæ˜¯å¯ä»¥è¿è¡Œè¿™äº›GUIåº”ç”¨çš„ï¼Œæ‰€ä»¥å¦‚æœæ˜¯ä¸ºäº†è¿è¡Œè¿™äº›GUIåº”ç”¨ï¼Œå…¶å®æ²¡å¿…è¦å®‰è£…å›¾å½¢åŒ–æ¡Œé¢ã€‚

## 2.3 æ˜¾ç¤ºç®¡ç†å™¨

[å¦‚ä½•åœ¨ Ubuntu æœåŠ¡å™¨ä¸Šå®‰è£…æ¡Œé¢ç¯å¢ƒï¼ˆGUIï¼‰ | Linux ä¸­å›½](https://zhuanlan.zhihu.com/p/373773218)

è¿™ä¸ªå·¥å…·çš„åŠŸèƒ½æ˜¯åœ¨ç®¡ç†ç”¨æˆ·å¯¹è¯å’Œé‰´æƒæ—¶å¯åŠ¨ [æ˜¾ç¤ºæœåŠ¡å™¨](https://itsfoss.com/display-server/) å¹¶åŠ è½½æ¡Œé¢ã€‚

GNOME æ¡Œé¢é»˜è®¤ä½¿ç”¨ GDM3 ä½œä¸ºæ˜¾ç¤ºç®¡ç†å™¨ï¼Œä»èµ„æºè§’åº¦è€ƒè™‘å®ƒæœ‰ç‚¹é‡ï¼›[lightdm](https://wiki.debian.org/LightDM) æ˜¯ä¸€ä¸ªè¾ƒä¸ºè½»é‡çº§å’Œèµ„æºå‹å¥½ä¸”å¹³å°æ— å…³çš„æ˜¾ç¤ºç®¡ç†å™¨ã€‚

```
# å¯é€‰ï¼Œéå¿…é¡»
sudo apt install lightdm
```

å®‰è£…åç³»ç»Ÿä¼šæç¤ºé€‰æ‹©é»˜è®¤çš„æ˜¾ç¤ºç®¡ç†å™¨ï¼Œå› ä¸ºå¤šä¸ªåªèƒ½é€‰æ‹©ä¸€ä¸ªã€‚

![Untitled](WSL2%EF%BC%884%EF%BC%89GUI%E7%9B%B8%E5%85%B3%20cfa7599e836b4e7d991561fec0b792bb/Untitled.png)

## 2.4 å…·ä½“æµç¨‹

[åœ¨WSLä¸­ä½¿ç”¨GPUï¼šWSL2 + Ubuntu 18.04 + CUDA + Gnomeå›¾å½¢ç•Œé¢ç¯å¢ƒé…ç½®_Ashkençš„åšå®¢-CSDNåšå®¢_wslä½¿ç”¨gpu](https://blog.csdn.net/Ashken/article/details/108974058)

ä¸Šè¿°ä¸‰ä¸ªè½¯ä»¶å‰è€…å®‰è£…åœ¨windowsä¸‹ï¼Œåä¸¤ä¸ªå®‰è£…åœ¨linuxä¸‹ã€‚

å¯åŠ¨æ­¥éª¤å¦‚ä¸‹ï¼š

1. windowsä¸‹å¯åŠ¨Ubuntuç»ˆç«¯
2. windowsä¸‹å¯åŠ¨VcXsrvï¼ŒæŒ‰å¦‚ä¸‹é…ç½®æ‰“å¼€ï¼Œåå‡ºç°ä¸€ä¸ªé»‘è‰²çª—å£
    
    ![Untitled](WSL2%EF%BC%884%EF%BC%89GUI%E7%9B%B8%E5%85%B3%20cfa7599e836b4e7d991561fec0b792bb/Untitled%201.png)
    
    ![Untitled](WSL2%EF%BC%884%EF%BC%89GUI%E7%9B%B8%E5%85%B3%20cfa7599e836b4e7d991561fec0b792bb/Untitled%202.png)
    
    ![Untitled](WSL2%EF%BC%884%EF%BC%89GUI%E7%9B%B8%E5%85%B3%20cfa7599e836b4e7d991561fec0b792bb/Untitled%203.png)
    
3. åœ¨Ubuntuä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤
    
    ```bash
    # è‹¥é‡‡ç”¨é»˜è®¤æ˜¾ç¤ºç®¡ç†å™¨
    sudo service dbus restart
    gnome-session
    # è‹¥é‡‡ç”¨lightdmæ˜¾ç¤ºç®¡ç†å™¨
    sudo service lightdm start
    gnome-session
    ```
    

æ­¤æ—¶å¯ä»¥åœ¨VcXsrvçª—å£çœ‹åˆ°Ubuntuæ¡Œé¢ã€‚